<div class="row">
  <div class="col-sm-12">
    <h1 class="text-center">Viking Store analytics dashboard</h1>
  </div>
</div>
<div class="row">
  <%= render 'overall_platform' %>

  <section class="user-demographics col-sm-6 border border-primary rounded">
    <h4 class="text-center">2. Users demographics and behavior</h4>

    <h5>Top 3 states users live in (billing)</h5>
    <%= render partial: 'most_lived_in_table', locals: { areas: @top_states } %>

    <h5>Top 3 cities users live in (billing)</h5>
    <%= render partial: 'most_lived_in_table', locals: { areas: @top_cities } %>

    <h5>Top users with...</h5>
    <%= render 'users_with_table' %>
  </section>
</div>

<div class="row">
  <section class="order-stats col-sm-6 border border-primary rounded">
    <h4 class="text-center">3. Orders statistics</h4>

    <h5>Last 7 days</h5>
    <%= render partial: 'order_statistics_table', locals: {
        orders: @orders_7,
        revenue: @revenue_7,
        average_order: @average_order_7,
        largest_order: @largest_order_7
    } %>

    <h5>Last 30 days</h5>
    <%= render partial: 'order_statistics_table', locals: {
        orders: @orders_30,
        revenue: @revenue_30,
        average_order: @average_order_30,
        largest_order: @largest_order_30
    } %>

    <h5>Total</h5>
    <%= render partial: 'order_statistics_table', locals: {
        orders: @orders,
        revenue: @revenue,
        average_order: @average_order,
        largest_order: @largest_order_30
    } %>
  </section>

  <section class="order-stats col-sm-6 border border-primary rounded">
    <h4 class="text-center">4. Time series data</h4>

    <h5>Orders by day</h5>
    <table class="table table-striped table-bordered table-sm">
      <thead class="thead-default">
      <tr>
        <th>Date</th>
        <th>Quantity</th>
        <th>Value</th>
      </tr>
      </thead>

      <% @orders_by_day.each_with_index do |day, i| %>
        <tr>
          <td><%= formatted_date(day) %></td>
          <td><%= day.quantity %></td>
          <td><%= day.value %></td>
        </tr>
      <% end %>
    </table>
  </section>
</div>